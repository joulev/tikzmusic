\newcommand\tmtrill[2][0]{
  \tm@note@getnote{#2}
  \ifdim\tm@note@average@diff pt<0pt
    \pgfmathtruncatemacro\tm@ornament@pos{ifthenelse(\tm@note@min@diff==-1,9,8)+#1}
  \else
    \pgfmathtruncatemacro\tm@ornament@pos{ifthenelse(\tm@note@max@diff<5,8,\tm@note@max@diff+4)+#1}
  \fi
  \pic[color/.expanded=\tmcolor] at (\tm@note@pos,\tm@ornament@pos*.1) {tm-trill};
}
\newcommand\tmturn[2][0]{
  \tm@note@getnote{#2}
  \ifdim\tm@note@average@diff pt<0pt
    \pgfmathtruncatemacro\tm@ornament@pos{ifthenelse(\tm@note@min@diff==-1,9,8)+#1}
  \else
    \pgfmathtruncatemacro\tm@ornament@pos{ifthenelse(\tm@note@max@diff<5,8,\tm@note@max@diff+4)+#1}
  \fi
  \pic[color/.expanded=\tmcolor] at (\tm@note@pos,\tm@ornament@pos*.1) {tm-turn};
}
\newcommand\tm@mordent[2][0]{
  \tm@note@getnote{#2}
  \ifdim\tm@note@average@diff pt<0pt
    \pgfmathtruncatemacro\tm@ornament@pos{ifthenelse(\tm@note@min@diff==-1,9,8)+#1}
  \else
    \pgfmathtruncatemacro\tm@ornament@pos{ifthenelse(\tm@note@max@diff<5,8,\tm@note@max@diff+4)+#1}
  \fi
  \pic[color/.expanded=\tmcolor] at (\tm@note@pos,\tm@ornament@pos*.1) {tm-mordent};
}
\def\tmmordent{\@ifstar\tmlowermordent\tm@mordent}
\newcommand\tmuppermordent[2][0]{\tm@mordent[#1]{#2}}
\newcommand\tmlowermordent[2][0]{
  \tm@mordent[#1]{#2}
  \draw[color/.expanded=\tmcolor,shift={(\tm@note@pos,\tm@ornament@pos*.1)},line width=.5pt] (0,-.15) -- (0,.15);
}